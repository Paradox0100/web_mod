<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>auto forwarder</title>
    <script>
        async function toServer(inputData) {
    try {
        const response = await fetch('http://127.0.0.1:5000/process', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ data: inputData }), // Sending data as JSON
        });

        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        // Get the content type of the response
        const contentType = response.headers.get('Content-Type');

        // Handle the response based on the content type
        switch (true) {
            case contentType.includes('text/html'):
                const newHtml = await response.text(); // Get the HTML response as text
                // Clear existing content and set new HTML
                document.open();
                document.write(newHtml);
                document.close();
                break;

            case contentType.includes('image/'):
                const blob = await response.blob(); // Get the image response as a blob
                const imgElement = document.createElement('img');
                imgElement.src = URL.createObjectURL(blob);
                document.body.innerHTML = ''; // Clear existing content
                document.body.appendChild(imgElement); // Append image to body
                break;

            case contentType.includes('application/json'):
                const jsonResponse = await response.json();
                console.log(jsonResponse); // Handle JSON response
                break;

            case contentType.includes('text/css'):
                const cssText = await response.text();
                const styleElement = document.createElement('style');
                styleElement.textContent = cssText; // Add CSS dynamically
                document.head.appendChild(styleElement);
                break;

            case contentType.includes('application/javascript'):
                const jsText = await response.text();
                const scriptElement = document.createElement('script');
                scriptElement.textContent = jsText; // Add JS dynamically
                document.body.appendChild(scriptElement);
                break;

            default:
                const text = await response.text();
                console.log(text); // Handle other text responses
                break;
        }
    } catch (error) {
        console.error('Error:', error);
        alert('Error sending data: ' + error.message);
    }
}
        function extractUrlParameter() {
            // Get the current URL
            const currentUrl = window.location.href;

            // Create a URL object
            const url = new URL(currentUrl);

            // Use URLSearchParams to get the query parameters
            const params = new URLSearchParams(url.search);

            // Get the value of the 'url' parameter
            const urlValue = params.get('url');

            toServer(urlValue)

            
        }

        // Call the function when the window loads
        window.onload = extractUrlParameter;
    </script>
</head>
<body>
    
</body>
</html>